<!-- admin.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Panel | SR Security</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #e0eafc, #cfdef3);
      padding: 20px;
      color: #333;
    }

    h1 {
      text-align: center;
      color: #0d47a1;
      margin-bottom: 30px;
      font-size: 2rem;
    }

    form {
      max-width: 800px;
      background: #fff;
      margin: auto;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    input, textarea, select, button {
      width: 100%;
      outline:none;
      padding: 12px;
      margin-top: 15px;
      font-size: 16px;
      border: 1px solid #bbb;
      border-radius: 6px;
      background: #fafafa;
      transition: border 0.3s;
    }
    input:hover, textarea:hover,select:hover{
      border:2px solid #01616b;
    }
    input:focus, textarea:focus, select:focus {
      border: 2px solid #0d47a1;
      background: #fff;
    }

    button {
      background: #0d47a1;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover {
      background: #1565c0;
    }

    table {
      width: 100%;
      margin-top: 40px;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.08);
    }

    th, td {
      padding: 12px 15px;
      border: 1px solid #ddd;
      text-align: left;
    }

    th {
      background-color: #0d47a1;
      color: #fff;
      font-weight: 600;
    }

    .actions button {
      background: #2196f3;
      border: none;
      color: white;
      padding: 6px 12px;
      border-radius: 5px;
      margin-right: 5px;
      font-size: 14px;
      cursor: pointer;
    }

    .actions button:last-child {
      background: #e53935;
    }

    @media (max-width: 768px) {
      form, table {
        width: 100%;
      }

      table, thead, tbody, th, td, tr {
        display: block;
      }

      thead {
        display: none;
      }

      td {
        padding: 10px;
        border: none;
        position: relative;
        padding-left: 50%;
      }

      td::before {
        content: attr(data-label);
        position: absolute;
        left: 10px;
        width: 45%;
        font-weight: bold;
        color: #333;
      }
    }
  </style>
</head>
<body>

<h1>üõ°Ô∏è SR Security Admin Panel</h1>

<form id="rateForm">
  <input type="text" id="serviceType" placeholder="Service Type" required />
  <textarea id="description" placeholder="Description" required></textarea>
  <input type="text" id="rate" placeholder="Rate (e.g. ‚Çπ23,791)" required />
  <button type="submit">Submit</button>
</form>

<table id="dataTable">
  <thead>
    <tr>
      <th>Service Type</th>
      <th>Description</th>
      <th>Rate</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getDatabase, ref, set, onValue, remove, get } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAKjdzj6gcl6bfqvaI8sYEJv8KCDnHUwSM",
    authDomain: "srsecurity-9d62a.firebaseapp.com",
    databaseURL: "https://srsecurity-9d62a-default-rtdb.firebaseio.com",
    projectId: "srsecurity-9d62a",
    storageBucket: "srsecurity-9d62a.appspot.com",
    messagingSenderId: "801710662719",
    appId: "1:801710662719:web:376de7896a74f5db03848a"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const servicesRef = ref(db, "services");

  const form = document.getElementById("rateForm");
  const tbody = document.querySelector("#dataTable tbody");

  let editingId = null;

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    const serviceType = document.getElementById("serviceType").value.trim();
    const description = document.getElementById("description").value.trim();
    const rate = document.getElementById("rate").value.trim();

    if (!serviceType || !description || !rate) return;

    const id = editingId || serviceType.toLowerCase().replace(/\s+/g, "_");

    await set(ref(db, `services/${id}`), {
      serviceType,
      description,
      rate
    });

    form.reset();
    editingId = null;
  });

  onValue(servicesRef, (snapshot) => {
    tbody.innerHTML = "";
    snapshot.forEach(child => {
      const id = child.key;
      const { serviceType, description, rate } = child.val();

      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td data-label="Service Type">${serviceType}</td>
        <td data-label="Description">${description}</td>
        <td data-label="Rate">${rate}</td>
        <td data-label="Actions" class="actions">
          <button onclick="editService('${id}')">Edit</button>
          <button onclick="deleteService('${id}')">Delete</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
  });

  window.editService = async (id) => {
    const snap = await get(ref(db, `services/${id}`));
    if (snap.exists()) {
      const data = snap.val();
      document.getElementById("serviceType").value = data.serviceType;
      document.getElementById("description").value = data.description;
      document.getElementById("rate").value = data.rate;
      editingId = id;
    }
  };

  window.deleteService = async (id) => {
    if (confirm("Delete this service?")) {
      await remove(ref(db, `services/${id}`));
    }
  };
</script>
</body>
</html>